"use strict";var APP_MAJOR_VERSION=4,APP_MINOR_VERSION=25,APP_REVISION="",APP_IS_MINIFIED_RELEASE=!0,APP_GOOGLE_ANALYTICS_ID="UA-47214311-1",hasMainAppScriptBeenAutoRetried=!1,hasGapiScriptBeenAutoRetried=!1,hasTestSuiteBeenAutoRetried=!1,hasAnalyticsScriptBeenAutoRetried=!1,hasAdSenseScriptBeenAutoRetried=!1,isAppLoadFailure=!1,appLoadFailureUiShown=!1,appLoadFailureMessage="",adsenseScriptLoadError=!1,adsenseScriptLoadErrorHasBeenLogged=!1,analyticsLoaded=!1;function isBrowserIE11OrOlder(){try{var e=window.navigator.userAgent;return 0<e.indexOf("MSIE ")?!0:0<e.indexOf("Trident/")}catch(e){return console.log("error during detection of browser: "+e),!0}}var isSupportedBrowser=!isBrowserIE11OrOlder(),adsbygoogle=null,dataLayer=null;function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],dataLayer=window.dataLayer,gtag("js",new Date),gtag("config",APP_GOOGLE_ANALYTICS_ID);var ze={};ze.VERSION=APP_MAJOR_VERSION+"."+APP_MINOR_VERSION+(""!=APP_REVISION?APP_REVISION:""),window.console.log("===== LOADING ZIP EXTRACTOR "+ze.VERSION+" ====="),window.console.log("isSupportedBrowser: ",isSupportedBrowser);var MAINAPP,APP_CONFIG={clientId:"824911851129-6d64j0e08s86ih74l0lu386tqqfv71t9.apps.googleusercontent.com",appId:"824911851129",scopes:"openid email profile https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/drive.install",apiKey:"AIzaSyBW4IYnFZLyPFFKtZ2qWJYTlURyyE-Vt_4"},firstAuthIsPending=!0,firstAuthSuccessful=!1,gapiAuthorizeCallPending=!1,gapiAuthorizeTimeoutId=null,GAPI_AUTHORIZE_TIMEOUT=4e3,domLoaded=!1,originalUrlState=null,CURRENT_AUTH_USER=0,CURRENT_USER_INFO=null,CLAIM=null,ID_TOKEN=null,ACCESS_TOKEN=null,isForDirectNew=isUrlParamKeyPresent("new"),isForTestSuite=isUrlParamKeyPresent("testsuite");function detectDevice(){return window.matchMedia("only screen and (max-width: 639px)").matches?"phone":window.matchMedia("only screen and (max-width: 765px)").matches?"device":"computer"}var urlContainsNew,urlContainsState,isValidReferrer,isIe11,deviceTypeForAdSense=detectDevice(),adLoadedDuringInit=!1,adNotLoadedReason="(default)";"phone"==deviceTypeForAdSense?(adLoadedDuringInit=!1,adNotLoadedReason="mobile device: "+deviceTypeForAdSense):isSupportedBrowser?window?isForTestSuite?(adLoadedDuringInit=!1,adNotLoadedReason="testSuite"):window&&null!=window.location&&null!=window.location.search?(urlContainsNew=-1!=window.location.search.indexOf("new"),urlContainsState=-1!=window.location.search.indexOf("state"),urlContainsNew?adLoadedDuringInit=!0:urlContainsState?window&&null!=window.document&&null!=window.document.referrer&&window.document.referrer.toLowerCase?(isValidReferrer=-1!=window.document.referrer.toLowerCase().indexOf(".google.com"))?adLoadedDuringInit=!0:(adLoadedDuringInit=!0,adNotLoadedReason="Detected an invalid referrer: "+window.document.referrer.toLowerCase()):(adLoadedDuringInit=!0,adNotLoadedReason="Did not detect valid referrer to parse. window.document.referrer: "+(window.document?window.document.referrer:"no_document")):(adLoadedDuringInit=!0,adNotLoadedReason='did not find "state" or "new" keywords in URL. window.location.search: '+window.location.search)):(adLoadedDuringInit=!0,adNotLoadedReason="Did not detect valid window search location to parse. window.location.search: "+(window.location?window.location.search:"no_location")):(adLoadedDuringInit=!1,adNotLoadedReason="window object not available"):(adLoadedDuringInit=!1,isIe11=-1!=(window.navigator.userAgent||"").indexOf("Trident/"),adNotLoadedReason="unsupported browser (isIe11="+isIe11+")"),isAppLoadFailure&&(adLoadedDuringInit=!1,adNotLoadedReason="appLoadFailure"),adLoadedDuringInit&&((adsbygoogle=window.adsbygoogle||[]).push({}),adLoadedDuringInit=!0);var STATE={};function getReferringSource(){var e=document&&document.referrer?document.referrer.toLowerCase():"";return-1!=e.indexOf("drive.google.com")?"drive":-1!=e.indexOf("mail.google.com")?"gmail":"general"}function execLater(e,t,o){return window.setTimeout(function(){e(),t&&t()},o||0)}function updateUiAfterDomLoadedForUnsupportedBrowser(){window.console.log("Showing alternate UI for unsupported browser."),logImpression("Unsupported browser: updateUiAfterDomLoad()","app_load"),showEl(document.getElementById("mainScrollableContent"),!1),showEl(document.getElementById("unsupportedBrowserContent"),!0)}function maybeUpdateUiAForAppLoadFailure(e){appLoadFailureUiShown||isSupportedBrowser&&(window.console.log("Showing alternate UI for app load failure."),document&&"loading"!==document.readyState&&(showEl(document.getElementById("mainScrollableContent"),!1),showEl(document.getElementById("appLoadErrorContent"),!0),document.getElementById("appLoadErrorDetails").textContent="Error details: "+e,appLoadFailureUiShown=!0,logImpression("app_load_failure","app_load",e)))}function closeTopAdBannerAndAdjustUi(){showEl(document.getElementById("topBanner"),!1),showEl(document.getElementById("adHeading"),!1),document.getElementById("zipTable").classList.add("adjustedHeightForNoAdShown"),document.getElementById("preview").classList.add("adjustedHeightForNoAdShown"),document.getElementById("mainScrollableContent").classList.add("adjustedHeightForNoAdShown"),document.getElementById("unsupportedBrowserContent").classList.add("adjustedHeightForNoAdShown"),document.getElementById("appLoadErrorContent").classList.add("adjustedHeightForNoAdShown"),document.getElementById("enableCookiesContent").classList.add("adjustedHeightForNoAdShown")}function handleDomLoaded(){try{if(domLoaded)return;if(domLoaded=!0,console.log("In handle Dom Loaded(). domLoaded: "+domLoaded+"; isSupportedBrowser: "+isSupportedBrowser),!adsenseScriptLoadError&&adLoadedDuringInit&&isSupportedBrowser||closeTopAdBannerAndAdjustUi(),!isSupportedBrowser)return void updateUiAfterDomLoadedForUnsupportedBrowser();if(isAppLoadFailure)return void maybeUpdateUiAForAppLoadFailure(appLoadFailureMessage);document.getElementById("copyright").textContent+=" v"+ze.VERSION,updateUiForDevice();var e=null!=getFileId(),t=e?getReferringSource():"general";e&&"gmail"!=t&&(t="drive");var o="drive"==t,r="gmail"==t,n=!(o||r||isForDirectNew);document.getElementById("startPageIconImgDrive").removeAttribute("visibilityHidden"),showEl(document.getElementById("startPageIconImgGeneral"),n||isForDirectNew),showEl(document.getElementById("startPageIconImgGmail"),r),showEl(document.getElementById("startPageIconImgDrive"),o),showEl(document.getElementById("startPageGeneralDetails"),n),showEl(document.getElementById("startPageGmailDetails"),r),showEl(document.getElementById("startPageDriveDetails"),o),showEl(document.getElementById("startPageNewDetails"),isForDirectNew),document.getElementById("startPageDriveDetails").style.visibility="",showEl(document.getElementById("startPagePrompt"),!0),document.getElementById("startPagePrompt").style.visibility="",MAINAPP&&(MAINAPP.initAfterDomLoaded(getFileId()),maybeStartTestSuite(MAINAPP))}catch(e){throw logImpression("handle_dom_loaded_err","app_load",e),e}}function showEl(e,t){e.hidden=!t}function isElementShown(e){return!e.hidden}function logImpression(e,t,o,r,n,i){var a;isForTestSuiteFlow()||(a={},null!=t&&(a.event_category=t),null!=o&&(a.event_label=o),null!=r&&(a.value=Number(r)),1==i&&(a.transport_type="beacon"),1==n&&(a.non_interaction=!0),0==Object.keys(a).length?gtag("event",e):gtag("event",e,a))}function revertUrlState(){window.history.replaceState({},"",originalUrlState)}function clearUrlState(){originalUrlState=window.location.href,window.history.replaceState({},"",window.location.pathname)}function onAnalyticsScriptLoaded(){console.log("analytics_script_loaded"),analyticsLoaded=!0,adLoadedDuringInit||logImpression("AD NOT LOADED; adLoadedDuringInit=false.","app_load","reason: "+adNotLoadedReason),adsenseScriptLoadError&&!adsenseScriptLoadErrorHasBeenLogged&&(logImpression("ADSENSE SCRIPT LOAD ERROR","app_load","source: onAnalyticsScriptLoaded"),adsenseScriptLoadErrorHasBeenLogged=!0)}function onAdSenseScriptLoaded(){console.log("adsense_script_loaded")}function onTestSuiteScriptLoaded(){console.log("test_suite_script_loaded"),MAINAPP&&maybeStartTestSuite(MAINAPP)}function onGapiScriptLoaded(){console.log("gapi_script_loaded")}function onMainAppScriptLoaded(){if(ze.App){console.log("main_app_script_loaded");try{MAINAPP=new ze.App,domLoaded&&(MAINAPP.initAfterDomLoaded(getFileId()),maybeStartTestSuite(MAINAPP))}catch(e){throw logImpression("main_app_bootstrap_error","app_load",e),e}}else onMainAppScriptLoadError("ze.App is not defined in onMainAppScriptLoaded().")}function maybeStartTestSuite(e){isForTestSuiteFlow()&&"zeTestSuite"in window&&zeTestSuite.init(e)}function isForTestSuiteFlow(){return isForTestSuite}function isForDirectNewFlow(){return isForDirectNew}function isForCreateNew(){return"create"==STATE.action&&!getFileId()}function isForOpen(){return"open"==STATE.action&&!!getFileId()}function getStateUserId(){return"{userId}"==STATE.userId||""==STATE.userId?null:STATE.userId}function getParentFolderId(){return STATE.folderId}function getFileId(){var e=STATE.ids;if(e)return e.length&&0<e.length?e[0]:null;var t=STATE.exportIds;return t&&t.length&&0<t.length?t[0]:null}function clearState(){STATE={}}function parseUrlState(){var e=null;try{var t=getUrlParam("state");if(!t)return{};e=JSON.parse(t)}catch(e){return logImpression("json_state_parse_error","app_load",e),{}}return e||{}}function isUrlParamKeyPresent(e){return e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),null!==new RegExp("[\\?&]"+e).exec(location.search)}function getUrlParam(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))}function onTestSuiteScriptLoadError(e){console.log("Test Suite Script Load Error"),handleScriptLoadError("testsuite_load_error",e,"hasBeenAutoRetried: "+hasTestSuiteBeenAutoRetried)}function onGapiScriptLoadError(e){handleScriptLoadError("gapi_load_error",e,"hasBeenAutoRetried: "+hasGapiScriptBeenAutoRetried),hasGapiScriptBeenAutoRetried?isForOpen()&&(isAppLoadFailure=!0,maybeUpdateUiAForAppLoadFailure(appLoadFailureMessage="gapi_load_error: "+getErrorStringFromErrorOrEvent(e))):(hasGapiScriptBeenAutoRetried=!0,loadGapiScript())}function onMainAppScriptLoadError(e){handleScriptLoadError("main_app_script_load_error","hasBeenAutoRetried: "+hasMainAppScriptBeenAutoRetried),hasMainAppScriptBeenAutoRetried?(isAppLoadFailure=!0,maybeUpdateUiAForAppLoadFailure(appLoadFailureMessage="main_app_script_load_error: "+getErrorStringFromErrorOrEvent(e))):(hasMainAppScriptBeenAutoRetried=!0,loadMainAppScript())}function onAnalyticsScriptLoadError(e){handleScriptLoadError("analytics_script_load_error","hasBeenAutoRetried: "+hasAnalyticsScriptBeenAutoRetried)}function onAdSenseScriptLoadError(e){adsenseScriptLoadError=!0,handleScriptLoadError("adsense_script_load_error","hasBeenAutoRetried: "+hasAdSenseScriptBeenAutoRetried),domLoaded&&closeTopAdBannerAndAdjustUi(),adsenseScriptLoadErrorHasBeenLogged||(logImpression("ADSENSE SCRIPT LOAD ERROR","app_load","source: onAdSenseScriptLoadError: "+(e||"")),adsenseScriptLoadErrorHasBeenLogged=!0)}function getErrorStringFromErrorOrEvent(e){var t="("+ze.VERSION+")";if(e&&e.originalEvent?e.originalEvent instanceof Event:e instanceof Event){var o=e.message||"",r=e.filename||"",n=e.lineno||"",i=e.colno||"",a=e.error||"",d=e.target||"",s=e.type||"",l=d&&d.src?d.src:"";return t+((o=(o=o&&" - "+o)&&" - "+o)+(s=s&&" - "+s)+(d=d&&" - "+d)+(l=l&&" - "+l)+(r=r&&" - "+r)+" @ ("+n+", "+i+")"+(a=a&&": "+a))}return t+" - "+e}function handleScriptLoadError(e,t){var o=getErrorStringFromErrorOrEvent(t);console.log("Script Load Error: "+e+" - "+o),logImpression(e,"script_load_error",o,void 0,void 0,!0)}function onGapiInit(){console.log("*** onGapiInit() CALLBACK"),execLater(function(){gapi.load("auth2",initiateFirstAuth)},void 0,1)}function initiateFirstAuth(){logImpression("gapi_loaded","app_load"),authorize(!0,bindFn(handleFirstAuthSuccess,window),bindFn(handleFirstAuthError,window),getStateUserId(),void 0,!1,"initiateFirstAuth")}function handleFirstAuthSuccess(){logImpression("first_auth_success","auth"),firstAuthSuccessful=!(firstAuthIsPending=!1),domLoaded&&MAINAPP&&MAINAPP.handleFirstAuthSuccess()}function handleFirstAuthError(e,t){firstAuthSuccessful=firstAuthIsPending=!1,domLoaded&&MAINAPP&&MAINAPP.handleFirstAuthError()}function authorize(e,t,o,r,n,i,a,d){if(d||logImpression("authorize","auth","immediate="+e+"; callingSource: "+a),!("gapi"in window&&!!gapi.auth2&&!!gapi.auth2.authorize))return logImpression("gapi_auth_not_ready","auth","immediate="+e+"; callingSource: "+a),void o("Error: GAPI Auth not initialized. callingSource: "+a);var s,l={client_id:APP_CONFIG.clientId,scope:APP_CONFIG.scopes,response_type:"token id_token"};e?l.prompt="none":i&&(l.prompt="select_account"),null!=r?(l.login_hint=r,l.authuser=-1):i||(s=null!=n?n:CURRENT_AUTH_USER||0,l.authuser=s);var u=bindFn(handleGapiAuthResult,window,t,o,!!d);try{gapiAuthorizeTimeoutId&&clearTimeout(gapiAuthorizeTimeoutId),gapiAuthorizeCallPending=!(gapiAuthorizeTimeoutId=null),gapi.auth2.authorize(l,u)}catch(e){var p={};return p.error=e,void u(p)}e&&gapiAuthorizeCallPending&&(gapiAuthorizeTimeoutId=execLater(function(){gapiAuthorizeCallPending&&(logImpression("timeout","auth","immediate="+e+"; callingSource: "+a),u({error:"The Google Authentication Server did not provide a response in time",error_subtype:"timeout"}))},void 0,GAPI_AUTHORIZE_TIMEOUT))}function handleGapiAuthResult(e,t,o,r){var n;gapiAuthorizeCallPending=!1,gapiAuthorizeTimeoutId&&(console.log("clearing auth timeout: "+gapiAuthorizeTimeoutId),clearTimeout(gapiAuthorizeTimeoutId)),gapiAuthorizeTimeoutId=null,r?r.error?(n=r.error+(r.error_subtype?" ("+r.error_subtype+")":""),r.details&&(n+=" ["+r.details+"]"),o||logImpression("auth_result","auth","error: "+n),t&&t(r.error,n)):(updateAuthDetailsFromAuthResponse(r),o||logImpression("auth_result","auth","success. authUser: "+CURRENT_AUTH_USER),e&&e()):(o||logImpression("auth_result","auth","(empty authResult)"),t?t(void 0):(o||logImpression("auth_result","auth","(showing alert because errorCallbackFn is undefined)"),alert("Auth Required. Please reload the page.")))}function bindFn(e,t,o){return e.call.apply(e.bind,arguments)}function getLoggedInUserId(){return CLAIM?CLAIM.sub:null}function updateAuthDetailsFromAuthResponse(e){ID_TOKEN=e.id_token,ACCESS_TOKEN=e.access_token,ID_TOKEN&&(CLAIM=parseJwtIdToken(ID_TOKEN));var t,o=0;e.session_state&&e.session_state.extraQueryParams&&(null!=(t=e.session_state.extraQueryParams).authuser&&(o=t.authuser)),CURRENT_AUTH_USER=o}function getUserEmail(){return CLAIM?CLAIM.email:null}function getUserFullName(){return CLAIM?CLAIM.name:null}function getUserGivenName(){return CLAIM?CLAIM.given_name:null}function getUserPicture(){return CLAIM?CLAIM.picture:null}function getUserDomain(){return CLAIM?CLAIM.hd:null}function getUserLocale(){return CLAIM?CLAIM.locale:null}function getAccessToken(){return ACCESS_TOKEN}function isTokenExpired(){return!(!CLAIM||null==CLAIM.exp)&&Math.round((new Date).getTime()/1e3)>CLAIM.exp}function parseJwtIdToken(e){if(!e)return{};var t=null;try{var o=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(window.atob(o)),t=JSON.parse(r)}catch(e){return logImpression("id_token_parse_error","app_load",e),{}}return t||{}}function isAuthorized(){return!!CLAIM}function isFirstAuthPending(){return firstAuthIsPending}function updateButtonTextHelper(e,t,o){var r=document.getElementById(e);r&&(r.childNodes[2]&&(r.childNodes[2].textContent=t),o&&(r.children[0].textContent=o))}function updateUiForDevice(){try{var e=detectDevice();"phone"!=e&&"device"!=e||(updateButtonTextHelper("openZipFromDriveButton","Open ZIP From Drive"),updateButtonTextHelper("createNewZipButton","New ZIP"),updateButtonTextHelper("saveZipToDriveButton","Save to Drive"),updateButtonTextHelper("openZipInDriveButton","Open ZIP"),updateButtonTextHelper("fixEncodingButton","Encoding"),"device"==e||"phone"==e&&(updateButtonTextHelper("openZipFromComputerButton","Open ZIP From Phone","smartphone"),updateButtonTextHelper("editZipButton","Edit"),updateButtonTextHelper("saveZipToDriveButton","Save")))}catch(e){logImpression("update_ui_for_device_err","app_load",e)}}function maybeHandleDomLoadedOrRegister(){if(!document)throw new Error("Document not available in maybeHandleDomLoadedOrRegister()");"loading"!==document.readyState?(console.log("maybeHandleDomLoadedOrRegister(): DOM already loaded."),handleDomLoaded()):(console.log("maybeHandleDomLoadedOrRegister(): DOM not yet ready, registering."),document.addEventListener("DOMContentLoaded",function(){handleDomLoaded()}))}function loadScript(e,t,o){var r=document.createElement("script");r.type="text/javascript",r.onload=function(){t&&t()},r.onerror=function(e){if(!o)throw e;o(e)},r.src=e,console.log("LOAD SCRIPT: "+e);try{document.head.appendChild(r)}catch(e){if(!o)throw e;o(e)}}function loadGapiScript(){loadScript("https://apis.google.com/js/api.js?onload=onGapiInit",bindFn(onGapiScriptLoaded),bindFn(onGapiScriptLoadError))}function loadMainAppScript(){loadScript("core-"+APP_MAJOR_VERSION+"-"+APP_MINOR_VERSION+APP_REVISION+(APP_IS_MINIFIED_RELEASE?"-min":"")+".js",bindFn(onMainAppScriptLoaded),bindFn(onMainAppScriptLoadError))}function loadAnalyticsScript(){loadScript("https://www.googletagmanager.com/gtag/js?id="+APP_GOOGLE_ANALYTICS_ID,bindFn(onAnalyticsScriptLoaded),bindFn(onAnalyticsScriptLoadError))}function loadAdSenseScript(){loadScript("https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js",bindFn(onAdSenseScriptLoaded),bindFn(onAdSenseScriptLoadError))}function loadTestSuiteScript(){loadScript("testsuite.js",bindFn(onTestSuiteScriptLoaded),bindFn(onTestSuiteScriptLoadError))}isForDirectNew||isForTestSuite||(STATE=parseUrlState(),clearUrlState()),window.onerror=function(t,e,o,r,n){try{var i=n&&n.stack?n.stack:"",a="("+ze.VERSION+") - "+e+" @ ("+o+", "+r+"): "+i;window.console.log("Unhandled ZIP Extractor App Error - "+t+": "+i),logImpression(t,"unhandled_js_error",a,void 0,void 0,!0),"zeTestSuite"in window&&"isForTestSuiteFlow"in window&&isForTestSuiteFlow()&&zeTestSuite.reportWindowError&&zeTestSuite.reportWindowError(a)}catch(e){window.console.log("*** Unhandled App Error: "+t+" - "+e)}},maybeHandleDomLoadedOrRegister(),isSupportedBrowser?(loadGapiScript(),loadMainAppScript(),isForTestSuiteFlow()||loadAnalyticsScript(),isForTestSuiteFlow()&&loadTestSuiteScript(),isAppLoadFailure&&(adLoadedDuringInit=!1,adNotLoadedReason="appLoadFailure",logImpression("App Load Failure: Skipping AdSense Script Load.","app_load"),window.console.log("App Load Failure: Skipping AdSense Script Load.")),adLoadedDuringInit?loadAdSenseScript():console.log("Skipping AdSense load.")):(logImpression("Unsupported browser: Skipping Script Load.","app_load"),window.console.log("Skipping loading additional scripts for unsupported browser."));