"use strict";window.zeZipLib={},zeZipLib.ZIP_EXTRACTOR_EXTRA_FIELD_SIGNATURE=17754,zeZipLib.ERR_HEADER_PARSE_ERROR="ZIP file is invalid or corrupted",zeZipLib.ERR_HEADER_UNSUPPORTED="ZIP file format is not supported",zeZipLib.ERR_HEADER_BAD_FORMAT="This file does not appear to be a ZIP file",zeZipLib.ERR_HEADER_READ="Error when reading the ZIP header",zeZipLib.ERR_ENTRY_BAD_FORMAT="ZIP entry format error",zeZipLib.ERR_ENCRYPTED="Password-protected ZIP files are not yet supported",zeZipLib.ERR_READ_GETDATA="Error while reading ZIP file array data",zeZipLib.ERR_READ_GETENTRIES="Error while reading ZIP file header",zeZipLib.ERR_INFLATION="Error while decompressing ZIP entry",zeZipLib.CENTRAL_DIRECTORY_HEADER_SIZE=46,zeZipLib.LOCAL_FILE_HEADER_ENTRY_FIXED_SIZE_BYTES=30,zeZipLib.EOCDR_SIZE=22,zeZipLib.ZIPCRYPTO_ENCRYPTION_HEADER_LENGTH=12,zeZipLib.ZIP_COMMENT_MAX_LEN=65536,zeZipLib.ZIP64_EOCDR_LOCATOR_SIZE=20,zeZipLib.ZIP64_EXTENSIBLE_DATA_SECTOR_MAX_SIZE=4096,zeZipLib.ZIP64_EOCDR_FIXED_SIZE=56,zeZipLib.ZIP64_EXTENDED_INFO_EXTRA_FIELD_SIGNATURE=1,zeZipLib.ZIP64_EXTENDED_INFO_EXTRA_FIELD_SIZE=28,zeZipLib.UNICODE_PATH_EXTRA_DATA_SIGNATURE=28789,zeZipLib.UNICODE_COMMENT_EXTRA_DATA_SIGNATURE=25461,zeZipLib.UNICODE_PATH_PREAMBLE_SIZE=5,zeZipLib.AES_EXTRA_DATA_SIGNATURE=39169,zeZipLib.AES_EXTRA_DATA_SIZE=7,zeZipLib.MAX_EOCDR_HEADER_SEEK_LEN=zeZipLib.EOCDR_SIZE+zeZipLib.ZIP_COMMENT_MAX_LEN+zeZipLib.ZIP64_EOCDR_LOCATOR_SIZE+zeZipLib.ZIP64_EXTENSIBLE_DATA_SECTOR_MAX_SIZE+zeZipLib.ZIP64_EOCDR_FIXED_SIZE,zeZipLib.COMPRESSION_MODE_STORE=0,zeZipLib.COMPRESSION_MODE_DEFLATE=8,zeZipLib.COMPRESSION_MODE_ENHANCED_DEFLATE=9,zeZipLib.COMPRESSION_MODE_BZIP=12,zeZipLib.COMPRESSION_MODE_LZMA=14,zeZipLib.COMPRESSION_MODE_ZSTD=93,zeZipLib.COMPRESSION_MODE_XZ=95,zeZipLib.COMPRESSION_MODE_JPEG=96,zeZipLib.COMPRESSION_MODE_WAVPACK=97,zeZipLib.COMPRESSION_MODE_PPMD=98,zeZipLib.COMPRESSION_MODE_WINZIPENCRYPTED=99,zeZipLib.ZIP_CENTRAL_DIRECTORY_HEADER_SIGNATURE=1347092738,zeZipLib.ZIP_LOCAL_FILE_HEADER_SIGNATURE=1347093252,zeZipLib.ZIP_DATA_DESCRIPTOR_SIGNATURE=1347094280,zeZipLib.ZIP_DATA_ARCHIVE_EXTRA_DATA_SIGNATURE=1347094024,zeZipLib.ZIP_64_EOCDR_DIGITAL_HEADER_SIGNATURE=1347093765,zeZipLib.ZIP_64_EOCDR_SIGNATURE=1347094022,zeZipLib.ZIP_64_EOCDR_LOCATOR_SIGNATURE=1347094023,zeZipLib.EOCDR_SIGNATURE=1347093766,zeZipLib.ASCII_TABLE=["Ç","ü","é","â","ä","à","å","ç","ê","ë","è","ï","î","ì","Ä","Å","É","æ","Æ","ô","ö","ò","û","ù","ÿ","Ö","Ü","ø","£","Ø","×","ƒ","á","í","ó","ú","ñ","Ñ","ª","º","¿","®","¬","½","¼","¡","«","»","_","_","_","¦","¦","Á","Â","À","©","¦","¦","+","+","¢","¥","+","+","-","-","+","-","+","ã","Ã","+","+","-","-","¦","-","+","¤","ð","Ð","Ê","Ë","È","i","Í","Î","Ï","+","+","_","_","¦","Ì","_","Ó","ß","Ô","Ò","õ","Õ","µ","þ","Þ","Ú","Û","Ù","ý","Ý","¯","´","­","±","_","¾","¶","§","÷","¸","°","¨","·","¹","³","²","_"," "],zeZipLib.decodeASCIIBytes=function(e){for(var i="",r=0;r<e.length;r++){var t=e[r];i+=127<t?zeZipLib.ASCII_TABLE[t-128]:String.fromCharCode(t)}return i},zeZipLib.isValidUtf8=function(e){for(var i=0,r=0,t=0,E=e.length;t!=e.length;){var n=255&e[t];if(n<=127)t+=1;else{if(194<=n&&n<=223)i=2;else if(224<=n&&n<=239)i=3;else{if(!(240<=n&&n<=244))return!1;i=4}if(E<=t+(i-1))return!1;for(var o=1;o<i;o++)if(128!=(192&e[t+o]))return!1;if(2==i)r=((31&e[t])<<6)+(63&e[t+1]);else if(3==i){if((r=((15&e[t])<<12)+((63&e[t+1])<<6)+(63&e[t+2]))<2048)return!1;if(r>>11==27)return!1}else if(4==i&&((r=((7&e[t])<<18)+((63&e[t+1])<<12)+((63&e[t+2])<<6)+(63&e[t+3]))<65536||1114111<r))return!1;t+=i}}return!0},zeZipLib.decodeStringFromDataView=function(e,i,r,t,E){var n=new Uint8Array(e.buffer,i,r);return zeZipLib.decodeStringFromTypedArray(n,t,E)},zeZipLib.decodeStringFromTypedArray=function(i,e,r){try{return r?new TextDecoder(r).decode(i):e?ze.App.TEXTDECODER_UTF8?ze.App.TEXTDECODER_UTF8.decode(i):ze.App.decodeUTF8Bytes(i):ze.App.TEXTDECODER_ASCII?ze.App.TEXTDECODER_ASCII.decode(i):zeZipLib.decodeASCIIBytes(i)}catch(e){logImpression("decode_string_error","misc",e);try{return zeZipLib.decodeASCIIBytes(i)}catch(e){return"Error: "+e}}},zeZipLib.convertDate=function(e){var i=(4294901760&e)>>16,r=65535&e;try{return new Date(1980+((65024&i)>>9),((480&i)>>5)-1,31&i,(63488&r)>>11,(2016&r)>>5,2*(31&r),0)}catch(e){return null}},zeZipLib.generateSpecialErrorDetailsStringForZipEocdrError=function(e,i,r,t,E){try{var n="Details: ("+ze.App.getFileExtension(i)+", "+r;if(!(2<=e.size))return void t(n+")");ze.App.blobToByteArrayAsync(e,0,2,function(e){var i=n+", "+e[0]+", "+e[1]+")";t(i)},E)}catch(e){return void E(e)}},zeZipLib.readHeaderMetadataFromEocdr=function(e,i,r,t,E,n){ze.App.blobToDataViewAsync(e,Math.max(0,e.size-zeZipLib.MAX_EOCDR_HEADER_SEEK_LEN),e.size,bindFn(zeZipLib.readZipHeaderRecordMetadata,null,e,i,r,t,E,n),n)},zeZipLib.readZipHeaderRecordMetadata=function(e,i,r,t,E,n,o){e.size;try{if(0==o.byteLength)return void n(zeZipLib.ERR_HEADER_PARSE_ERROR+" - ZIP file is empty (zero bytes) and contains no actual data.");if(o.byteLength<zeZipLib.EOCDR_SIZE)return void n(zeZipLib.ERR_HEADER_PARSE_ERROR+" - ZIP file size is not large enough for EOCDR.");for(var p=-1,_=o.byteLength-zeZipLib.EOCDR_SIZE;_<o.byteLength-4;_++)if(o.getUint32(_)==zeZipLib.EOCDR_SIGNATURE){p=_;break}var a,R=0;if(-1==p)for(R=Math.max(0,o.byteLength-zeZipLib.MAX_EOCDR_HEADER_SEEK_LEN);R<o.byteLength-4;R++)o.getUint32(R)==zeZipLib.EOCDR_SIGNATURE&&(p=R);if(-1==p)return void(null==r||r==ze.App.CANONICAL_MIME_TYPES.ZIP||r==ze.App.CANONICAL_MIME_TYPES.ZIP2||r==ze.App.CANONICAL_MIME_TYPES.ZIP3?(a=zeZipLib.ERR_HEADER_PARSE_ERROR+" - Did not find EOCDR signature. Please try re-downloading your ZIP file from the original source.",zeZipLib.generateSpecialErrorDetailsStringForZipEocdrError(e,i,r,function(e){n(a+" - "+e)},function(e){n(a+" - "+e)})):n("This file does not appear to be a ZIP file. Instead, this file's type was detected as: "+r,!1,!0,r,e));if(o.byteLength-p<zeZipLib.EOCDR_SIZE)return void n(zeZipLib.ERR_HEADER_PARSE_ERROR+" - EOCDR not large enough");var Z={};if(0<=p-zeZipLib.ZIP64_EOCDR_LOCATOR_SIZE)if(o.getUint32(p-20)==zeZipLib.ZIP_64_EOCDR_LOCATOR_SIGNATURE){Z.isZip64=!0;var s=zeZipLib.readUint64FromDataView(o,p-12,!0);if(!Number.isSafeInteger(s))return void n(zeZipLib.ERR_HEADER_UNSUPPORTED+" - ZIP64 EOCDR Relative Offset > MAX_SAFE_INTEGER");var A=t-s,L=o.byteLength-A;if((Z.zip64Index=L)<0)return void n(zeZipLib.ERR_HEADER_PARSE_ERROR+" - Not enough bytes to reverse-seek to ZIP64 EOCDR");if(o.getUint32(L)!=zeZipLib.ZIP_64_EOCDR_SIGNATURE)return void n(zeZipLib.ERR_HEADER_PARSE_ERROR+" - Did not find ZIP64 EOCDR signature where expected");var I=o.getUint32(4+L,!0);if(0<o.getUint32(8+L,!0))return void n(zeZipLib.ERR_HEADER_UNSUPPORTED+" - ZIP64 EocdrSize > Integer.MAX_VALUE, requires long");Z.zip64EocdrSize=I;var d=o.getUint32(16+L,!0),z=o.getUint32(20+L,!0);if(d!=z)return void n(zeZipLib.ERR_HEADER_UNSUPPORTED+" - ZIP64 NumberOfThisDisk != ZIP64 NumberOfTheDiskWithCD");Z.zip64NumberOfThisDisk=d,Z.zip64NumberOfTheDiskWithStartOfCentralDirectory=z;var b=o.getUint32(24+L,!0);if(0<o.getUint32(28+L,!0))return void n(zeZipLib.ERR_HEADER_UNSUPPORTED+" - ZIP64 TotalEntriesOnDisk > Integer.MAX_VALUE, requires long");Z.zip64TotalEntriesOnDisk=b;var D=o.getUint32(32+L,!0);if(0<o.getUint32(36+L,!0))return void n(zeZipLib.ERR_HEADER_UNSUPPORTED+" - ZIP64 TotalEntriesInCd > Integer.MAX_VALUE, requires long");Z.zip64TotalEntriesInCd=D;var O=o.getUint32(40+L,!0);if(0<o.getUint32(44+L,!0))return void n(zeZipLib.ERR_HEADER_UNSUPPORTED+" - ZIP64 CdSize > Integer.MAX_VALUE, requires long");Z.zip64CdSize=O;var T=zeZipLib.readUint64FromDataView(o,48+L,!0);if(!Number.isSafeInteger(T))return void n(zeZipLib.ERR_HEADER_UNSUPPORTED+" - ZIP64 CdOffsetOfStart > MAX_SAFE_INTEGER");Z.zip64CdOffsetOfStart=T;var C=I-zeZipLib.ZIP64_EOCDR_FIXED_SIZE+12;Z.zip64ExtensibleDataSectorSize=C}var S=o.getUint16(p+4,!0);65535==S&&Z.isZip64&&(S=Z.zip64NumberOfThisDisk),Z.numberOfThisDisk=S;var N=o.getUint16(p+6,!0);65535==N&&Z.isZip64&&(N=Z.zip64NumberOfTheDiskWithStartOfCentralDirectory),Z.numberOfTheDiskWithStartOfCentralDirectory=N,Z.numExtraZipParts=Math.max(S,N);var c=o.getUint16(p+8,!0);65535==c&&Z.isZip64&&(c=Z.zip64TotalEntriesInCd);var P=o.getUint32(p+12,!0);4294967295==P&&Z.isZip64&&(P=Z.zip64CdSize);var f=o.getUint32(p+16,!0);4294967295==f&&Z.isZip64&&(f=Z.zip64CdOffsetOfStart);var y=Z.isZip64?Z.zip64Index:p,u=o.byteLength-y,l=o.getUint16(p+20,!0),M="";return 0<l&&(M=zeZipLib.decodeStringFromDataView(o,p+22,l,!0)),Z.numFiles=c,Z.cdrAbsoluteOffset=f,Z.cdrSize=P,Z.zipFileComment=M,Z.eocdrStartDistanceFromEnd=u,Z.cdrStartDistanceFromEnd=u+P,void E(Z)}catch(e){return console.log(e),console.trace(),void n(zeZipLib.ERR_HEADER_PARSE_ERROR+" - General Error - "+e)}},zeZipLib.readEntriesFromCentralDirectory=function(e,i,r,t){i.size<e.cdrStartDistanceFromEnd?t(zeZipLib.ERR_HEADER_READ+" - Tail blob size not large enough for CDR"):ze.App.blobToDataViewAsync(i,i.size-e.cdrStartDistanceFromEnd,i.size,bindFn(zeZipLib.doReadEntriesFromCdr,null,r,t,e.numFiles,!!e.isZip64,e.encoding),t)},zeZipLib.doReadEntriesFromCdr=function(e,i,r,t,E,n){for(var o=0,p=1,_=[],a=0;a<r;a++){if(n.getUint32(o)!=zeZipLib.ZIP_CENTRAL_DIRECTORY_HEADER_SIGNATURE)return void i(zeZipLib.ERR_HEADER_BAD_FORMAT+" - Expected Header Signature for this file's record");var R={};try{R=zeZipLib.generateEntryFromHeaderRecord(n,o+4,t,E)}catch(e){R.error="Entry Parse Error from CDR: "+e;var Z=ze.App.getErrorDetailsFromErrorObject(e);logImpression("entry_parse_error_cdr","zip",(e||"")+" - isZip64: "+t+"; entry.filenameLength: "+R.filenameLength+"; opt_encoding: "+E+"; errDetails: "+Z)}R.error||null!=R.compressionMethod&&(zeZipLib.isZipCompressionMethodSupported(R.compressionMethod)||(R.error="Unsupported ZIP compression method: "+R.compressionMethod,logImpression("entry_unsupported_compression_method","zip",R.compressionMethod))),ze.App.postProcessEntryFilenameAndMaybeSkip(R,p++)||_.push(R),o+=zeZipLib.CENTRAL_DIRECTORY_HEADER_SIZE+R.filenameLength+R.extraFieldLength+R.commentLength}e(_)},zeZipLib.isZipCompressionMethodSupported=function(e){return e==zeZipLib.COMPRESSION_MODE_DEFLATE||e==zeZipLib.COMPRESSION_MODE_ENHANCED_DEFLATE||e==zeZipLib.COMPRESSION_MODE_STORE||e==zeZipLib.COMPRESSION_MODE_BZIP||e==zeZipLib.COMPRESSION_MODE_LZMA||e==zeZipLib.COMPRESSION_MODE_XZ||e==zeZipLib.COMPRESSION_MODE_PPMD||e==zeZipLib.COMPRESSION_MODE_WINZIPENCRYPTED},zeZipLib.generateEntryFromHeaderRecord=function(e,i,r,t){var E={type:"zip"};E.madeByVersion=e.getUint16(i,!0),E.version=e.getUint16(i+2,!0),E.bitFlag=e.getUint16(i+4,!0),E.compressionMethod=e.getUint16(i+6,!0),E.lastModDateRaw=e.getUint32(i+8,!0),E.lastModDate=zeZipLib.convertDate(E.lastModDateRaw),zeZipLib.populateEntryEncryptionDetails(E);var n=!1,o=!1,p=!1,_=!1;E.crc32=e.getUint32(i+12,!0),0===E.crc32&&(E.crc32=null),E.compressedSize=e.getUint32(i+16,!0),E.uncompressedSize=e.getUint32(i+20,!0),4294967295!==E.uncompressedSize&&4294967295!==E.compressedSize||(E.isZip64=!0,4294967295===E.uncompressedSize&&(o=!0),4294967295===E.compressedSize&&(n=!0)),E.filenameLength=e.getUint16(i+24,!0),E.extraFieldLength=e.getUint16(i+26,!0),E.commentLength=e.getUint16(i+28,!0);var a=e.getUint16(i+30,!0);65535===a?_=E.isZip64=!0:E.diskNumberStart=a,E.directory=16==(16&e.getUint8(i+34));var R=e.getUint32(i+38,!0);4294967295===R?p=E.isZip64=!0:E.offset=R;var Z=i+42+E.filenameLength,s=zeZipLib.readExtraFields(e,Z,E.extraFieldLength);if(E.isZip64){var A=0;if(o&&(A+=8),n&&(A+=8),p&&(A+=8),_&&(A+=4),0<A){if(!(zeZipLib.ZIP64_EXTENDED_INFO_EXTRA_FIELD_SIGNATURE in s))return E.error="Did not find ZIP64_EXTENDED_INFO_EXTRA_FIELD for this Zip64 entry.",E;var L=s[zeZipLib.ZIP64_EXTENDED_INFO_EXTRA_FIELD_SIGNATURE];if(L.dataSize<A)return E.error="Error: Expected Extra Field Length >= "+A+" for Zip64 Entry.",E;var I,d=L.dataStart;if(o){var z=zeZipLib.readUint64FromDataView(e,d,!0);if(!Number.isSafeInteger(z))return E.error="Error: ZIP64 Entry Uncompressed Size > MAX_SAFE_INTEGER",E;E.uncompressedSize=z,d+=8}if(n){var b=zeZipLib.readUint64FromDataView(e,d,!0);if(!Number.isSafeInteger(b))return E.error="Error: ZIP64 Entry Compressed Size > MAX_SAFE_INTEGER",E;E.compressedSize=b,d+=8}if(p){var D=zeZipLib.readUint64FromDataView(e,d,!0);if(!Number.isSafeInteger(D))return E.error="Error: ZIP64 Entry Offset > MAX_SAFE_INTEGER",E;E.offset=D,d+=8}_&&(I=e.getUint32(d,!0),E.diskNumberStart=I,d+=4)}}var O=!1,T=2048==(2048&E.bitFlag);if(zeZipLib.UNICODE_PATH_EXTRA_DATA_SIGNATURE in s){var C=s[zeZipLib.UNICODE_PATH_EXTRA_DATA_SIGNATURE],S=C.dataStart+zeZipLib.UNICODE_PATH_PREAMBLE_SIZE,N=C.dataSize-zeZipLib.UNICODE_PATH_PREAMBLE_SIZE;try{E.filename=zeZipLib.decodeStringFromDataView(e,S,N,!0,void 0),O=!0}catch(e){logImpression("unicode_path_extra_data_parse_error","zip","error: "+e)}}if(!O){var c=new Uint8Array(e.buffer,i+42,E.filenameLength),P=!1;if(T)P=!0;else{for(var f=!1,y=0;y<c.length;y++)if(127<c[y]){f=!0,E.filenameHasExtendedChar=!0;break}E.rawFilenameBytes=c,P=!!f&&zeZipLib.isValidUtf8(c)}E.filename=zeZipLib.decodeStringFromTypedArray(c,P,t)}if(E.directory||"/"!=E.filename.charAt(E.filename.length-1)||(E.directory=!0),0<E.commentLength?E.comment=zeZipLib.decodeStringFromDataView(e,i+42+E.filenameLength+E.extraFieldLength,E.commentLength,T,void 0):E.comment="",E.encryptionMode==zeZipLib.ENCRYPTION_MODE_WINZIPAES){if(!(zeZipLib.AES_EXTRA_DATA_SIGNATURE in s))return E.error="Error: Did not find AES Extra Data Record Extra Fields Map.",E;var u=s[zeZipLib.AES_EXTRA_DATA_SIGNATURE];if(u.dataSize<zeZipLib.AES_EXTRA_DATA_SIZE)return E.error="Error: Expected Extra Field Length >= 7 for AES encryption format.",E;var l=null;try{l=zeZipLib.Crypto.Aes.readAesExtraDataRecord(e,u.dataStart)}catch(e){return E.error="Error reading Encryption Data Record: "+e,E}null!=l&&(E.compressionMethod=l.compressionMethod,E.aesKeyStrengthBits=l.keyStrengthBits)}return E},zeZipLib.readUint64FromDataView=function(e,i,r){var t=e.getUint32(i,!!r),E=e.getUint32(i+4,!!r);return r?t+Math.pow(2,32)*E:E+Math.pow(2,32)*t},zeZipLib.readExtraFields=function(e,i,r){var t={},E=i;for(null==r&&(r=0);E<i+r;){var n=e.getUint16(E,!0);E+=2;var o=e.getUint16(E,!0),p={dataStart:E+=2,dataSize:o};E+=o,t[n]=p}return t},zeZipLib.ENCRYPTION_MODE_NONE="none",zeZipLib.ENCRYPTION_MODE_UNKNOWN="unknown",zeZipLib.ENCRYPTION_MODE_PKZIPSTANDARD="pkzipstandard",zeZipLib.ENCRYPTION_MODE_PKZIPSTRONG="pkzipstrong",zeZipLib.ENCRYPTION_MODE_WINZIPAES="winzipaes",zeZipLib.ENCRYPTION_MODE_PKZIPOTHER="pkzipother",zeZipLib.ENCRYPTION_MODE_ENCRYPTEDCDR="encryptedcdr",zeZipLib.populateEntryEncryptionDetails=function(e){e.encryptionMode=zeZipLib.ENCRYPTION_MODE_NONE,e.isEncrypted=1==(1&e.bitFlag),e.hasEncryptedCdr=8192==(8192&e.bitFlag),e.isEncrypted&&(e.hasEncryptedCdr?e.encryptionMode=zeZipLib.ENCRYPTION_MODE_ENCRYPTEDCDR:(e.encryptionMode=zeZipLib.ENCRYPTION_MODE_UNKNOWN,e.compressionMethod==zeZipLib.COMPRESSION_MODE_WINZIPENCRYPTED?e.encryptionMode=zeZipLib.ENCRYPTION_MODE_WINZIPAES:64==(64&e.bitFlag)?e.encryptionMode=zeZipLib.ENCRYPTION_MODE_PKZIPSTRONG:10==e.version||20==e.version||21==e.version||45==e.version||46==e.version||63==e.version||788==e.version||e.compressionMethod==zeZipLib.COMPRESSION_MODE_BZIP||e.compressionMethod==zeZipLib.COMPRESSION_MODE_LZMA||e.compressionMethod==zeZipLib.COMPRESSION_MODE_PPMD?e.encryptionMode=zeZipLib.ENCRYPTION_MODE_PKZIPSTANDARD:e.encryptionMode=zeZipLib.ENCRYPTION_MODE_PKZIPOTHER))},zeZipLib.decompressZipEntry=function(r,e,t,E,n,o,p,_,a,R,Z,s,A,i,L,I){if(0!=e.byteLength)if(e.byteLength<4)Z(zeZipLib.ERR_ENTRY_BAD_FORMAT+" - Not enough bytes in entry data payload for local file signature");else if(e.getUint32(0)==zeZipLib.ZIP_LOCAL_FILE_HEADER_SIGNATURE)if(e.byteLength<zeZipLib.LOCAL_FILE_HEADER_ENTRY_FIXED_SIZE_BYTES)Z(zeZipLib.ERR_ENTRY_BAD_FORMAT+" - Not enough bytes in entry data payload");else{var d=e.getUint16(26,!0),z=e.getUint16(28,!0),b=1==(1&o);if(!b||null!=i&&0!=i.length){var D=zeZipLib.LOCAL_FILE_HEADER_ENTRY_FIXED_SIZE_BYTES+d+z,O=null,T=null;if(b){if(null==(O=zeZipLib.processZipEncryptionHeader(a,E,e,D,d,z,Z,i,L)))return;if(T=O.encryptionParams,E=O.newCompressedSize,D=O.newHeaderDataOffset,O.hasAuthenticationCode){var C=t+O.authenticationCodeOffset;return void ze.App.blobToByteArrayAsync(r,C,C+O.authenticationCodeLength,function(e){T.authenticationCodeBytes=e;var i=t+D;zeZipLib.decompressZipPayload(r,i,E,n,o,p,_,a,R,Z,T,s,A,I,e)},Z)}}var S=t+D;zeZipLib.decompressZipPayload(r,S,E,n,o,p,_,a,R,Z,T,s,A,I)}else Z(zeZipLib.ERR_INFLATION+" - ZIP file is encrypted but no password was provided")}else Z(zeZipLib.ERR_ENTRY_BAD_FORMAT+" - Did not find Local File Header signature for this entry. Instead, found bytes: ("+e.getUint8(0)+", "+e.getUint8(1)+", "+e.getUint8(2)+", "+e.getUint8(3)+")");else Z(zeZipLib.ERR_ENTRY_BAD_FORMAT+" - Empty Entry Data Payload in DataView")},zeZipLib.decompressZipPayload=function(e,i,r,t,E,n,o,p,_,a,R,Z,s,A){var L=null,I=null,d={};if(o===zeZipLib.COMPRESSION_MODE_BZIP)L=ze.App.LIB_BZIP_SCRIPT_NAME,I=ze.App.CHUNK_SIZE_BZIP;else if(o===zeZipLib.COMPRESSION_MODE_LZMA){if(r<5)return void a("ZIP file LZMA compressedSize must be at least 5, but was: "+r);L=ze.App.LIB_LZMA_SCRIPT_NAME,I=ze.App.CHUNK_SIZE_LZMA,t=2==(2&E)?-1:t}else if(o===zeZipLib.COMPRESSION_MODE_XZ)L=ze.App.LIB_XZ_SCRIPT_NAME,I=ze.App.CHUNK_SIZE_XZ;else if(o===zeZipLib.COMPRESSION_MODE_PPMD)L=ze.App.LIB_PPMDI_SCRIPT_NAME,I=ze.App.CHUNK_SIZE_PPMDI;else{if(o===zeZipLib.COMPRESSION_MODE_JPEG||o===zeZipLib.COMPRESSION_MODE_WAVPACK)return void a("Unsupported ZIP compression method in decompressZipEntry(): "+o);var z=o==zeZipLib.COMPRESSION_MODE_DEFLATE,b=o==zeZipLib.COMPRESSION_MODE_ENHANCED_DEFLATE,D=o===zeZipLib.COMPRESSION_MODE_STORE;if(!(z||b||D))return void a("Unsupported ZIP compression method; expected Enhanced or Standard DEFLATE, or STORE, but was: "+o);L=ze.App.LIB_INFLATE_SCRIPT_NAME,b?d.deflate64=!0:D&&(d.stored=!0),I=D?ze.App.CHUNK_SIZE_COPY:ze.App.CHUNK_SIZE_INFLATE}ze.App.genericDecompressWithWorker(new Worker(L),I,e,i,r,t,n,_,a,p,R,d,Z,s,!1,A)},zeZipLib.processZipEncryptionHeader=function(e,i,r,t,E,n,o,p,_){var a={};if(e==zeZipLib.ENCRYPTION_MODE_PKZIPSTANDARD){a.newCompressedSize=i-zeZipLib.ZIPCRYPTO_ENCRYPTION_HEADER_LENGTH;var R=new Int8Array(r.buffer,t,zeZipLib.ZIPCRYPTO_ENCRYPTION_HEADER_LENGTH);a.encryptionParams=zeZipLib.Crypto.deriveZipCryptoKeys(R,p),a.newHeaderDataOffset=t+zeZipLib.ZIPCRYPTO_ENCRYPTION_HEADER_LENGTH}else{if(e!=zeZipLib.ENCRYPTION_MODE_WINZIPAES)return o("Decryption error: Unsupported encryption mode: "+e),null;if(null==_)return o(zeZipLib.ERR_INFLATION+" - ZIP file is AES password protected but AES Key Strength was not provided"),null;var Z=_/16,s=Z+zeZipLib.Crypto.Aes.PASSWORD_VERIFIER_LENGTH;if(t+s>r.byteLength)return o("Decryption error: Encrypted Header ("+(t+s)+") extends past dataView ("+r.byteLength+")"),null;var A=new Uint8Array(r.buffer,t,Z);try{var L=performance.now();a.encryptionParams=zeZipLib.Crypto.Aes.initializeWinzipAes(_,A,p);performance.now()}catch(e){return o(e),null}var I=t+Z,d=new Uint8Array(r.buffer,I,zeZipLib.Crypto.Aes.PASSWORD_VERIFIER_LENGTH);if(d[0]!=a.encryptionParams.derivedPasswordVerificationBytes[0]||d[1]!=a.encryptionParams.derivedPasswordVerificationBytes[1])return o("Incorrect Password. Password did not match verification bytes."),null;var z=i-Z-zeZipLib.Crypto.Aes.PASSWORD_VERIFIER_LENGTH-zeZipLib.Crypto.Aes.AUTHENTICATION_CODE_LENGTH;a.newCompressedSize=z;var b=t+Z+zeZipLib.Crypto.Aes.PASSWORD_VERIFIER_LENGTH+z;a.hasAuthenticationCode=!0,a.authenticationCodeOffset=b,a.authenticationCodeLength=zeZipLib.Crypto.Aes.AUTHENTICATION_CODE_LENGTH,a.newHeaderDataOffset=t+s}return a},zeZipLib.Crypto={},zeZipLib.Crypto.ENCRYPTION_HEADER_LENGTH=12,zeZipLib.Crypto.CRC_TABLE=null,zeZipLib.Crypto.ensureCrc32LookupTableForZipCryptoComputed=function(){if(null==zeZipLib.Crypto.CRC_TABLE){for(var e=new Int32Array(256),i=0;i<256;i++){for(var r=i,t=0;t<8;t++)1==(1&r)?r=r>>>1^3988292384:r>>>=1;e[i]=r}zeZipLib.Crypto.CRC_TABLE=e}},zeZipLib.Crypto.crc32=function(e,i){return e>>>8^zeZipLib.Crypto.CRC_TABLE[255&(e^i)]},zeZipLib.Crypto.deriveZipCryptoKeys=function(e,i){if(!e||e.length!=zeZipLib.Crypto.ENCRYPTION_HEADER_LENGTH)throw new Error("ZipCrypto error: Encrypted Header must be 12 bytes long");zeZipLib.Crypto.ensureCrc32LookupTableForZipCryptoComputed();var r=new Int32Array(3);r[0]=305419896,r[1]=591751049,r[2]=878082192;for(var t=new Int8Array(1),E=0,n=0;n<i.length;n++)zeZipLib.Crypto.update_keys_from_byte(r,i[n]),E=2|r[2],t[0]=Math.imul(E,1^E)>>>8;for(var o=new Int8Array(zeZipLib.Crypto.ENCRYPTION_HEADER_LENGTH),p=0;p<zeZipLib.Crypto.ENCRYPTION_HEADER_LENGTH;p++)o[p]=zeZipLib.Crypto.update_keys_from_byte(r,e[p]^t[0]),E=2|r[2],t[0]=Math.imul(E,1^E)>>>8;var _={};return _.keys=r,_},zeZipLib.Crypto.update_keys_from_byte=function(e,i){return e[0]=zeZipLib.Crypto.crc32(e[0],i),e[1]+=255&e[0],e[1]=Math.imul(e[1],134775813)+1,e[2]=zeZipLib.Crypto.crc32(e[2],e[1]>>24&255),i},zeZipLib.Crypto.decryptChunkBytesInPlaceZipCrypto=function(e,i){var r=i.keys;if(!r||3!=r.length)throw new Error("ZipCrypto error: Decryption keys required for ZipCrypto encryption");for(var t=2|r[2],E=zeZipLib.Crypto.CRC_TABLE,n=0;n<e.length;n++)e[n]^=Math.imul(t,1^t)>>>8,r[0]=r[0]>>>8^E[255&(r[0]^e[n])],r[1]=Math.imul(r[1]+(255&r[0]),134775813)+1,r[2]=r[2]>>>8^E[255&(r[2]^r[1]>>24)],t=2|r[2]},zeZipLib.Crypto.Aes={},zeZipLib.Crypto.Aes.PASSWORD_VERIFIER_LENGTH=2,zeZipLib.Crypto.Aes.AUTHENTICATION_CODE_LENGTH=10,zeZipLib.Crypto.Aes.VENDOR_ID_SIGNATURE=17729,zeZipLib.Crypto.Aes.EXTRA_DATA_RECORD_LENGTH=11,zeZipLib.Crypto.Aes.AE1_SIGNATURE_BYTE=1,zeZipLib.Crypto.Aes.AE2_SIGNATURE_BYTE=2,zeZipLib.Crypto.Aes.ENCRYPTION_STRENGTH_128=1,zeZipLib.Crypto.Aes.ENCRYPTION_STRENGTH_192=2,zeZipLib.Crypto.Aes.ENCRYPTION_STRENGTH_256=3,zeZipLib.Crypto.Aes.AES_BLOCK_SIZE=16,zeZipLib.Crypto.Aes.PBKDF2_ITERATIONS=1e3,zeZipLib.Crypto.Aes.readAesExtraDataRecord=function(e,i){var r={},t=e.getUint16(i,!0);r.vendorVersion=t,r.encryptionMode=t==zeZipLib.Crypto.Aes.AE1_SIGNATURE_BYTE?"AE-1":t==zeZipLib.Crypto.Aes.AE2_SIGNATURE_BYTE?"AE-2":"Unknown";var E=e.getUint16(i+2,!0);if((r.vendorId=E)!=zeZipLib.Crypto.Aes.VENDOR_ID_SIGNATURE)throw new Error('AES Decryption error: Expected "AE" for Vendor ID, instead found: '+E);var n=e.getUint8(i+4,!0);if(r.encryptionStrengthMode=n,r.keyStrengthBits=n==zeZipLib.Crypto.Aes.ENCRYPTION_STRENGTH_128?128:n==zeZipLib.Crypto.Aes.ENCRYPTION_STRENGTH_192?192:n==zeZipLib.Crypto.Aes.ENCRYPTION_STRENGTH_256?256:-1,-1==r.keyStrengthBits)throw new Error("AES Decryption error: Invalid AES Encryption Strength: "+r.keyStrengthBits+" ("+r.encryptionStrengthMode+")");return r.compressionMethod=e.getUint16(i+5,!0),r},zeZipLib.Crypto.Aes.initializeWinzipAes=function(e,i,r){var t=e/8,E=t,n=t+E+zeZipLib.Crypto.Aes.PASSWORD_VERIFIER_LENGTH,o=Sha1.pbkdf2(r,i,zeZipLib.Crypto.Aes.PBKDF2_ITERATIONS,n);if(o.length!=n)throw new Error("AES Decryption error: derivedKeyBytes length ("+o.length+") does not match expected ("+n+")");var p=o.slice(0,t),_=o.slice(t,t+E),a={};return a.derivedPasswordVerificationBytes=o.slice(t+E,t+E+zeZipLib.Crypto.Aes.PASSWORD_VERIFIER_LENGTH),a.hmac=Sha1.createhmacSha1(_),a.aes=new aesjs.ModeOfOperation.ctr(p,1,!0),a},zeZipLib.Crypto.Aes.verifyWinzipAesAuthenticationCode=function(e,i){var r=i.digest();if(!r||r.length<zeZipLib.Crypto.Aes.AUTHENTICATION_CODE_LENGTH)throw new Error("AES Decryption error: Could not get minimum 10 bytes from final Mac digest to authenticate");for(var t=!0,E=0;E<zeZipLib.Crypto.Aes.AUTHENTICATION_CODE_LENGTH;E++)if(e[E]!=r[E]){t=!1;break}return!!t},zeZipLib.Crypto.Aes.decryptChunkBytesInPlaceWinZipAes=function(e,i){i.hmac.update(e),i.aes.encryptOrDecryptFullChunkInPlaceFast(e)};